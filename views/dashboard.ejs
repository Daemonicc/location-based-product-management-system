<%- include ("partials/header") %>

  <div class="container px-4 row gx-4">
    <h1>Showing products <%=distance%> mile raduis of <%= currentUser.location.formattedAddress%>
    </h1>

    <% if( products.length < 1) { %>
      <div class="alert alert-danger" role="alert">
        There is no product available in your location at the moment
      </div>
      <%}%>

        <form class="row row-cols-lg-auto g-3 align-items-center" method="GET" action="/">
          <div class="col-12">
            <label class="visually-hidden" for="inlineFormInputGroupUsername">Miles</label>
            <div class="input-group">
              <div class="input-group-text">Miles</div>
              <input type="number" class="form-control" name="distance" id="inlineFormInputGroupUsername"
                placeholder="Enter search raduis">
            </div>
          </div>

          <div class="col-12">
            <button type="submit" class="btn btn-primary">Submit</button>
          </div>
        </form>

        <% products.forEach(function(product) { %>
          <div class="card col-3 mr-4" style="width: 18rem; margin: 2rem;">
            <img src="data:image/<%=product.img.contentType%>;base64,<%=product.img.data.toString('base64')%>"
              class="card-img-top" style="width: 100%; max-height: 20vh;">
            <div class="card-body">
              <h5 class="card-title">
                <%=product.name%>
              </h5>
              <p class="card-text">
                <%=product.description%>
              </p>
              <a href="/products/<%=product._id%>" class="btn btn-primary">View Product</a>
            </div>
          </div>
          <% }) %>

  </div>

  </div>


  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.6.0/dist/umd/popper.min.js"
    integrity="sha384-KsvD1yqQ1/1+IA7gi3P0tyJcT3vR+NdBTt13hSJ2lnve8agRGXTTyNaBYmCR/Nwi"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.min.js"
    integrity="sha384-nsg8ua9HAw1y0W1btsyWgBklPnCUAFLuTMS2G72MMONqmOymq585AcH49TLBQObG"
    crossorigin="anonymous"></script>
  </body>

  </html>